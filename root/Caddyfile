# =============================================================================
# CADDY CONFIGURATION - PCS Template
# =============================================================================
# Container routing is handled via Docker labels (caddy-docker-proxy)
# This file defines global config and reusable snippets only
# =============================================================================

{
    log {
        output stdout
        format console
    }

    # Let's Encrypt email for certificate registration (used for nip.io domains)
    email {$PCS_EMAIL}
}

# Custom CA TLS for gateway-routed domains
# Gateway trusts this CA, so no LE needed for these routes
(gateway_tls) {
    tls /certs/cert.pem /certs/key.pem
}

# No :80 block needed - caddy-docker-proxy handles HTTPâ†’HTTPS redirects
# via container labels, and Caddy's internal ACME handler responds to
# /.well-known/acme-challenge/* requests automatically
#
# nip.io routing for CF Worker direct connections is handled via container labels
# (e.g., caddy_1: admin-${PUBLIC_IP_DASH}.nip.io) in docker-compose.yml
